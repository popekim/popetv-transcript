예, 안녕하세요. 포프입니다.

그 동안 프로그래밍 얘기를 좀 안 한 것 같으니까 프로그래밍 얘기를 좀 해 볼게요. 예전에 제가 스페이스 마린(Space Marine) 만들 때였던 것 같아요. 그 때 한참 메모리 스톰핑(Memory stomping) 문제도 있고, 메모리… 메모리 스톰핑이 뭐냐면 그, 그 메모리가 있는데 이제 다른 엉뚱한 곳에서 이 메모리를 덮어쓴다거나 그래 가지고 뭐, 메모리 오버플로우(Memory overflow)라고도 할 수 있겠고, 메모리 내용이 문제가 생긴 거죠. 문제가 생긴 거죠. 원래 들어가지 말아야 될 메모리 주소에 무언가 들어간 거죠. 내용이.

그런데 그런 거를 디버깅(Debugging)하다가 든 생각이 있었어요. 메모리 코럽션(Memory corruption)이라고도 하죠, 어떤 경우에는. (메모리 손상) 메모리 코럽션이 났을 때, 이제 그걸 보면 거기 뭐 브레이크 포인트(Break point)를 걸거나 조건을 달아 가지고 디텍트(Detect)를 하잖아요. 메모리 코럽션이 있다고.

그럼 딱 브레이크 포인트를 걸고 보면은 "어, 그래 이 메모리에 문제 있는 게 써졌구나"라는 걸 알아요. 근데 과연 이 값이 어디서 왔느냐? 이걸 알아채기가 제일… 이걸 알아내는 게 정말 힘든 일이에요. 왜냐하면 이 메모리가 잘못 써질 때를 딱 디텍트해 가지고 브레이크 포인트를 딱 걸고 싶은데, 대부분의 경우에는 그 메모리에 뭔가 써졌고, 나중에 그 메모리를 읽어서 무언가를 하려고 할 때, 그 때, 그 때 문제가 발생하는 경우가 많거든요.

그래서 그 때 든 생각이 그거였어요. 저는 콘솔 개발자니까 콘솔은 보통 개발할 때, 콘솔은 보통 개발할 때 하드웨어가 있거든요? 개발킷, Dev Kit(Development Kit)이 따로 있어요. 그래서 거기에 연결을 해서 디버깅을 하는데, 뭐 한 마디로 Xbox 360 Dev Kit이라고 하면 Xbox 360하고 비슷한데 거기다가 디버깅 기능을 추가한 하드웨어예요.

그래서 뭐 랜선 타고 거기다 디버깅을 하던가 아니면 뭐 특별히 USB 케이블을 꽂아 가지고 디버깅을 할 수 있는 건데, 콘솔에서는 이걸 해결할 수 있는 방법이 있지 않을까? 라는 생각을 많이 했어요.

그게, 생각이 뭐였냐면 제가 원했던… 제가 원했던 디버깅 피쳐(Feature)는, 그러니까 기능은 메모리가 바뀔 때마다 그 메모리 바뀌는 거를 다 녹화, 녹음(Record)할 수 있는 기계. 그러니까 메모리가 여기 알로케이션(Allocation)인지 뭔지 (할당인지) 100바이트(byte)가 됐다는 내용도 적어두고, 그 다음에 메모리를 여기다 뭘 쓰면은 여기 이 값이 써졌다. 이런 식으로.

아니면 정말 단순하게 매, 매 초마다… 아니, 프레임(Frame)마다 메모리 스냅샷(Snapshot). 그러니까 메모리가 현재는 이 모양. 4기ㄱ...(4gb)… 그 때는 메모리가 512메가(512mb)밖에 안 됐으니까. 512메가 내용이 전부 이거니까 덤프(Dump)해 두고, 다음 프레임에서 덤프해 두고. 이제 나중에 무언가 문제가 생겼을 때 그 히스토리(History)를 다 보면서 "여기 메모리에 뭐가 언제 어디에 써졌나?" 이런 거를 볼 수 있는 거.

당연히 그런 게 없죠. 없었죠. 없었죠.

그러고, 그래서 이제 저희들은 보통 메모리 내용 쓰는 것까진 아닌데, 메모리 알로케이션하고 디알로케이션(Deallocation) 되는 거는 (메모리 할당 해제) 자체적으로 프로그램을 만들어서 알로케이션 될 때마다 이벤트를 쏴 가지고 TCP/IP로 연결을 해 가지고 프로그램에다 기억을 하는 그런 메모리 트래커(Tracker)는 저희도 있었어요. 뭐, 웬만한 게임회사에는 다 있을 거고.

그런데 정작 메모리에 뭐 내용이 써지는지 확인하는 건, 현재 메모리 스냅샷이 어떻다는 거, 뭐 10프레임 전에… 뭐 10프레임 전에 스냅샷이 어떻다는 거, 스냅샷이 어떻다는 거. 요거를 녹화할 수 있는 기능을 가진 게임엔진은 본 적이 없어요. 하드웨어도, 그러니까 콘솔 쪽도 저는 본 적이 없고.

그래서 그런 게 있으면 좋겠다는 생각을 많이 했고, 그리고 그 당시 이제 저랑 친하게 지내던, 뭐 이제 영국으로 돌아갔지만… 노을(Noel)이라는 프로그래머하고 그런 얘기를 했었어요. 그런 얘기를 했었어요. 그 친구도 "이야, 그런 거 있었으면 정말 좋겠다."

저는 그 당시가 이제 2010년? 2011년? 뭐 그때쯤이었을 때니까 차세대 콘솔이 나온다 만다라는 얘기가 있을 때거든요. 그래서 저는 차세대 콘솔에 그런 걸 은근히 기대했어요. 차세대 콘솔은 디버깅이 더 편하게, 그런… 메모리 히스토리… 메모리 스냅샷을 찍는 방법. 그러니까 자동적으로 찍어서 지난 100… 아니야, 120프레임 동안 히스토리 보여주는 거. 어디에 뭐가 쓰여졌는지 찾을 수 있게 해 주는 거.

그런 기능이 있지 않을까… 아니면 그거를 독립적인 하드웨어, 애드온(Add-on)으로 해 가지고 하지 않을까… 그 마이크로소프트 트랜잭션(현질) 식으로. 그러지 않을까?란 생각은 많이 했는데 불행히도 그러진 않았어요.

그래서 참… 아, 이런 게 있으면 정말 디버깅하기 편한 건데… 너무 아쉽다란 생각을 많이 했고요.

그래서 아직도 그 문제는 그대로 있죠. 메모리 코럽션 나는 거, 메모리 스톰핑 나는 거. 디버깅 하기가 정말 까다로워요. 이거는 정말 코드 훑어가면서, 로직 확인해 가면서… 아니면 정말 운이 좋게 그 메모리 위치에 특별한 값이 있다. 내가 딱 봐도 "아, 이건 어디서 온 값이다"라는 걸 알 수 있는 값이 있으면 좋고요. 그러면 디버깅은 쉬운데, 그렇지 않으면 정말 어렵죠.

그리고 요즘처럼 멀티쓰레딩 돼 가지고 이제 여러 쓰레드들에서 한 메모리에 접근하는 그런 상황에서 더더욱! 복잡해지고 힘들고. 왜냐하면 그거는 리프로(버그가 다시 나타나게) 하기가 너무 힘들기 때문에.

그게 참… 무슨 방법이 있을까라는 생각을 하다가 결론적으로 말하면 제가 아는 방법은 없어요.

근데 최근에, 근데 최근에 인터넷을 뒤져 보다가 타임머신 디버깅이라는 개념을 갖고 있는 놈이 있더라고요. 그래서 타임머신 디버깅이 뭐냐면, 현재 여기서 이런 문제가 생겼을 때, 이 메모리 위치에 있었던 거를 돌아가서 누가 예전에 이걸 썼는지를 볼 수 있는 디버깅 기능이 있는… 컴파일러(Compiler)라고 해야 되나? 디버거(Debugger)라고 해야겠다. 디버거가 있어요.

그게, 그게 문제는 PC용은 아니에요. 왜냐면 메모리 주소도 워낙 넓고, 그 메모리 다 기록하는 것도 말도 안 되고. 오히려 임베디드(Embedded) 쪽에선 봤어요. 임베디드… 뭐 조그만… 기기에 들어가는 그런 거 있잖아요. 그런 거는 메모리가 커봐야, 뭐 거기 메모리가 얼마나 큰지 지금은 모르겠는데, 작은 거는 1메가 미만도 있을 거고, 몇 메가 기껏해 봐야 그거일 테니까.

디버깅하는 도중에 1메가 정도 매번 덤프하는 건 별로 문제가 안 되거든요. 한… 1기가 덤프하는 건 문제가 있지만.

그래서 그런 기능이 있는 디버거를 찾았어요. 임베디드 시스템 쪽에서. 그래서 "아, 저게 바로 내가 원했던 건데."

내부적으로 구현 원리는 몰라요. 메모리를 전부 다 덤프하는지, 아니면 메모리 쓰고 읽을 때마다 그런 뭐 이벤트를 넣어 갖고 기록을 하는지. 델타(Delta)를 기록하냐 전체를 매번 기록하냐인데.

그래서 그런 기능이 있으면 좋겠다는 생각을 하고, 그리고 그런 기능이 이미 임베디드 쪽에 있기 때문에 제 생각에는 PC쪽 기반에서도 그걸 구현할 수는 있을 것 같아요. 델타를 기록하는 방법이라거나, 아니면 선택적으로 어느 메모리 구역을 녹화하는 거나… 녹음? 녹화… 기록! 기록이라고 하죠.

제 생각에는 그렇게 선택적으로 하는 거는 가능할 거라고 보거든요? 그리고 그런 게 가능하니까 아마 큰 디버거 만드는 회사들 쪽에서도 아마 보고 있는 문제가 아닐까?란 생각을 해요. 그러기가 쉽겠죠, 당연히? 제가 생각했는데 아무도 생각 못했을 리는 없을 것 같고.

그래서 분명히 저와 똑같은 생각을 하셨던 분들도 계실 거예요. 보고 계시는 분들 중에 "아, 이런 기능이 있으면 좋겠다." 아니면 거기까진 아니어도 "왜 이거를 이렇게 해결하기 어려운 문제인가?" 그런 불만이라도 가지셨던 분들.

그런 불만이 있으시면 있으실수록 여러 번 이렇게 보이스를 내 주셔야… 보이스를 내 주는 게 뭐지? 공개적으로 말씀을 좀 하시고. 컴파일러 회사나 디버거 회사… 디버거 회사라고 봐야 되지. 그쪽 회사 쪽에 계속 제안을 주고. 그래야만 이런 기능이 나올 것 같거든요.

저는 개인적으로 상당히 봤으면 좋겠다는 기능이에요. 그런 메모리 스톰핑이 자주 일어나는 건 아니겠지만, 메모리 스톰핑 한 번 고치려면 정말 시간 오래 걸리기 때문에 제 생각에는 굉장히 값어치가 큰 기능이 아닐까 생각을 해요.

그래서 혹시라도 저와 비슷한 생각이 있었다거나, 아니면 이에 반대되는 의견이 있으신 분들은 네, 댓글로 남겨 주세요. 궁금해요, 다들 어떻게 생각하시는지.

오늘 제가 하고 싶었던 얘기는 그렇게 디버깅 기능이 있었으면 좋겠다, 그거였고요. 별로 유용한 정보였는지 아니었는지는 모르겠어요. 그런데 한 번 생각 좀 해 보시면 괜찮겠다 싶어서 만들었고요.

그러면 이 정도로 끝내죠. 포프였습니다.

